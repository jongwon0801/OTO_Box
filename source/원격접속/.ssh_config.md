#### Host와 HostName의 차이점

Host:

```less
Host는 SSH 설정의 이름 alias입니다. 즉, 사용자가 SSH 명령어에서 사용할 수 있는 이름입니다.

예를 들어, Host o2obox-tunnel을 정의하면, SSH 명령어에서 o2obox-tunnel을 호스트 이름으로 사용할 수 있습니다.

이것은 HostName에 정의된 실제 서버의 IP 주소나 도메인 이름과는 관계없습니다.
```

```less
Host o2obox-tunnel
    HostName server
    User root
    Port 2222
```
```less
위의 경우 Host가 o2obox-tunnel인 경우,
ssh o2obox-tunnel을 입력하면 HostName server에 정의된 server에 SSH 연결이 됩니다.
```
---
HostName:

```less
HostName은 실제로 SSH가 연결하려는 서버의 IP 주소 또는 도메인 이름입니다.

예를 들어, HostName server는 server라는 이름의 실제 호스트(도메인 또는 IP)로 SSH 연결을 시도하게 만듭니다.
만약 server가 ~/.ssh/config에 정의되지 않으면, server는 /etc/hosts나 DNS에서 IP를 찾아야 합니다.
```
```less
# HostName은 실제로 연결할 서버의 정보를 지정합니다.

Host o2obox-tunnel
    HostName server   # 실제 연결할 서버의 이름 또는 IP
    User root
    Port 2222
```
---

#### pi config 수정
```less
# sudo nano /home/pi/.ssh/config
# nano ~/.ssh/config

Host o2obox-ssh
HostName      server
User          root
Port          2222
IdentityFile  /home/pi/.ssh/id_rsa
#RemoteForward  11045 localhost:8000
RemoteForward  41045 localhost:22
ServerAliveInterval 300
ServerAliveCountMax 2
ExitOnForwardFailure yes
TCPKeepAlive yes
```

#### root config 수정
```less
# sudo nano /root/.ssh/config

Host o2obox-tunnel
HostName      server
User          root
Port          2222
IdentityFile  /home/pi/.ssh/id_rsa
RemoteForward  11045 localhost:8000
#RemoteForward  41045 localhost:22
ServerAliveInterval 300
ServerAliveCountMax 2
ExitOnForwardFailure yes
TCPKeepAlive yes
```

#### 주의 !!
```less
ssh는 기본적으로 현재 로그인한 사용자의 ~/.ssh/config 파일을 사용합니다.

pi 사용자로 로그인한 상태라면 /home/pi/.ssh/config 파일을 사용합니다.

root 사용자로 로그인한 상태라면 /root/.ssh/config 파일을 사용합니다.

-> 다른 계정의 alias 로 ssh o2obox-ssh,  o2obox-tunnel 같은거 하면
No address associated with hostname 에러뜸
```

- 만약 리버스 ssh 또는 직접 접속으로 포트가 열려있는 상태면 접속 안됨

---

#### 127.0.0.1:41039 으로 리슨하는 이유

🔧 GatewayPorts 설정 설명

서버의 /etc/ssh/sshd_config 파일 안에 이 설정이 있습니다

```less
GatewayPorts no        # 기본값
no이면 → RemoteForward 포트가 서버에서 127.0.0.1 (localhost)에만 리슨합니다.

yes이면 → 서버에서 0.0.0.0 (모든 인터페이스)에 리슨합니다.

clientspecified이면 → 클라이언트가 RemoteForward에 명시한 IP 기준으로 리슨합니다.
```
```less
127.0.0.1:41039 으로 리슨하는 이유는

서버의 sshd_config에서 GatewayPorts가 no이기 때문입니다.
즉, Reverse 포트를 외부에서 접속 못 하게 localhost로만 제한한 겁니다.
```


